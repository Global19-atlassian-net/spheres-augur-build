# Define path to the conda environment file.
conda_environment: "../../spheres_profile/conda.yaml"

# Define custom auspice configuration to enable frequencies.
files:
  auspice_config: "spheres_profile/auspice_config.json"

# Define builds for each state and territory.
builds:
  alabama:
    colors: spheres_profile/state_colors/alabama_colors.tsv
    division: Alabama
    subsampling_scheme: state-territory
  alaska:
    colors: spheres_profile/state_colors/alaska_colors.tsv
    division: Alaska
    subsampling_scheme: state-territory
  arizona:
    colors: spheres_profile/state_colors/arizona_colors.tsv
    division: Arizona
    subsampling_scheme: state-territory
  arkansas:
    colors: spheres_profile/state_colors/arkansas_colors.tsv
    division: Arkansas
    subsampling_scheme: state-territory
  california:
    colors: spheres_profile/state_colors/california_colors.tsv
    division: California
    subsampling_scheme: state-territory
  colorado:
    colors: spheres_profile/state_colors/colorado_colors.tsv
    division: Colorado
    subsampling_scheme: state-territory
  connecticut:
    colors: spheres_profile/state_colors/connecticut_colors.tsv
    division: Connecticut
    subsampling_scheme: state-territory
  delaware:
    colors: spheres_profile/state_colors/delaware_colors.tsv
    division: Delaware
    subsampling_scheme: state-territory
  florida:
    colors: spheres_profile/state_colors/florida_colors.tsv
    division: Florida
    subsampling_scheme: state-territory
  georgia:
    colors: spheres_profile/state_colors/georgia_colors.tsv
    division: Georgia
    subsampling_scheme: state-territory
  hawaii:
    colors: spheres_profile/state_colors/hawaii_colors.tsv
    division: Hawaii
    subsampling_scheme: state-territory
  idaho:
    colors: spheres_profile/state_colors/idaho_colors.tsv
    division: Idaho
    subsampling_scheme: state-territory
  illinois:
    colors: spheres_profile/state_colors/illinois_colors.tsv
    division: Illinois
    subsampling_scheme: state-territory
  indiana:
    colors: spheres_profile/state_colors/indiana_colors.tsv
    division: Indiana
    subsampling_scheme: state-territory
  iowa:
    colors: spheres_profile/state_colors/iowa_colors.tsv
    division: Iowa
    subsampling_scheme: state-territory
  kansas:
    colors: spheres_profile/state_colors/kansas_colors.tsv
    division: Kansas
    subsampling_scheme: state-territory
  kentucky:
    colors: spheres_profile/state_colors/kentucky_colors.tsv
    division: Kentucky
    subsampling_scheme: state-territory
  louisiana:
    colors: spheres_profile/state_colors/louisiana_colors.tsv
    division: Louisiana
    subsampling_scheme: state-territory
  maine:
    colors: spheres_profile/state_colors/maine_colors.tsv
    division: Maine
    subsampling_scheme: state-territory
  maryland:
    colors: spheres_profile/state_colors/maryland_colors.tsv
    division: Maryland
    subsampling_scheme: state-territory
  massachusetts:
    colors: spheres_profile/state_colors/massachusetts_colors.tsv
    division: Massachusetts
    subsampling_scheme: state-territory
  michigan:
    colors: spheres_profile/state_colors/michigan_colors.tsv
    division: Michigan
    subsampling_scheme: state-territory
  minnesota:
    colors: spheres_profile/state_colors/minnesota_colors.tsv
    division: Minnesota
    subsampling_scheme: state-territory
  mississippi:
    colors: spheres_profile/state_colors/mississippi_colors.tsv
    division: Mississippi
    subsampling_scheme: state-territory
  missouri:
    colors: spheres_profile/state_colors/missouri_colors.tsv
    division: Missouri
    subsampling_scheme: state-territory
  montana:
    colors: spheres_profile/state_colors/montana_colors.tsv
    division: Montana
    subsampling_scheme: state-territory
  nebraska:
    colors: spheres_profile/state_colors/nebraska_colors.tsv
    division: Nebraska
    subsampling_scheme: state-territory
  nevada:
    colors: spheres_profile/state_colors/nevada_colors.tsv
    division: Nevada
    subsampling_scheme: state-territory
  new-hampshire:
    colors: spheres_profile/state_colors/new-hampshire_colors.tsv
    division: New Hampshire
    subsampling_scheme: state-territory
  new-jersey:
    colors: spheres_profile/state_colors/new-jersey_colors.tsv
    division: New Jersey
    subsampling_scheme: state-territory
  new-mexico:
    colors: spheres_profile/state_colors/new-mexico_colors.tsv
    division: New Mexico
    subsampling_scheme: state-territory
  new-york:
    colors: spheres_profile/state_colors/new-york_colors.tsv
    division: New York
    subsampling_scheme: state-territory
  north-carolina:
    colors: spheres_profile/state_colors/north-carolina_colors.tsv
    division: North Carolina
    subsampling_scheme: state-territory
  north-dakota:
    colors: spheres_profile/state_colors/north-dakota_colors.tsv
    division: North Dakota
    subsampling_scheme: state-territory
  ohio:
    colors: spheres_profile/state_colors/ohio_colors.tsv
    division: Ohio
    subsampling_scheme: state-territory
  oklahoma:
    colors: spheres_profile/state_colors/oklahoma_colors.tsv
    division: Oklahoma
    subsampling_scheme: state-territory
  oregon:
    colors: spheres_profile/state_colors/oregon_colors.tsv
    division: Oregon
    subsampling_scheme: state-territory
  pennsylvania:
    colors: spheres_profile/state_colors/pennsylvania_colors.tsv
    division: Pennsylvania
    subsampling_scheme: state-territory
  puerto-rico:
    colors: spheres_profile/state_colors/puerto-rico_colors.tsv
    division: Puerto Rico
    subsampling_scheme: state-territory
  rhode-island:
    colors: spheres_profile/state_colors/rhode-island_colors.tsv
    division: Rhode Island
    subsampling_scheme: state-territory
  south-carolina:
    colors: spheres_profile/state_colors/south-carolina_colors.tsv
    division: South Carolina
    subsampling_scheme: state-territory
  south-dakota:
    colors: spheres_profile/state_colors/south-dakota_colors.tsv
    division: South Dakota
    subsampling_scheme: state-territory
  tennessee:
    colors: spheres_profile/state_colors/tennessee_colors.tsv
    division: Tennessee
    subsampling_scheme: state-territory
  texas:
    colors: spheres_profile/state_colors/texas_colors.tsv
    division: Texas
    subsampling_scheme: state-territory
  utah:
    colors: spheres_profile/state_colors/utah_colors.tsv
    division: Utah
    subsampling_scheme: state-territory
  vermont:
    colors: spheres_profile/state_colors/vermont_colors.tsv
    division: Vermont
    subsampling_scheme: state-territory
  virginia:
    colors: spheres_profile/state_colors/virginia_colors.tsv
    division: Virginia
    subsampling_scheme: state-territory
  washington:
    colors: spheres_profile/state_colors/washington_colors.tsv
    division: Washington
    subsampling_scheme: state-territory
  washington-dc:
    colors: spheres_profile/state_colors/washington-dc_colors.tsv
    division: Washington DC
    subsampling_scheme: state-territory
  west-virginia:
    colors: spheres_profile/state_colors/west-virginia_colors.tsv
    division: West Virginia
    subsampling_scheme: state-territory
  wisconsin:
    colors: spheres_profile/state_colors/wisconsin_colors.tsv
    division: Wisconsin
    subsampling_scheme: state-territory
  wyoming:
    colors: spheres_profile/state_colors/wyoming_colors.tsv
    division: Wyoming
    subsampling_scheme: state-territory

# Define subsampling scheme for state- and territory-level (hereafter
# "division") builds. This scheme should include as much local diversity for a
# given division as possible and contextual samples from the rest of the USA and
# the world.
subsampling:
  state-territory:
    local-focus:
      # Evenly sample across time for the current division.
      group_by: "year month"
      max_sequences: 1000
      query: --query "(country == 'USA' & division == '{division}')"
    usa-context:
      # Evenly sample across time from other divisions prioritizing samples that
      # are that are genetically similar to the current division's sequences.
      group_by: "year month"
      max_sequences: 800
      query: --query "(country == 'USA' & division != '{division}')"
      priorities:
        type: proximity
        focus: local-focus
    global-context:
      # Evenly sample across time from the rest of the world excluding the USA.
      group_by: "region year month"
      max_sequences: 800
      query: --query "(country != 'USA')"
      priorities:
        type: proximity
        focus: local-focus
